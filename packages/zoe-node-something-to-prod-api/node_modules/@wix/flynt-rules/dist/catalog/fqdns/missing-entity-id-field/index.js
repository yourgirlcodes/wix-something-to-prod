"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.rule = void 0;
const fqdn_utils_1 = require("../../fqdn-utils");
const wix_protos_1 = require("@wix/wix-protos");
exports.rule = {
    description: 'A message containing an fqdn annotation must have an id field',
    breakIfNew: true,
    run(ctx) {
        ctx.visit({
            visitMessage(message) {
                const messageOptions = message.options.getTypedOption(wix_protos_1.wix.api.entity);
                if (messageOptions && messageOptions.value.fqdn) {
                    ctx.assert(message.fields.byName('id'), {
                        errorAt: message,
                        message: `the message '${(0, fqdn_utils_1.toLocalFqn)(message.fqn)}' must have an 'id' field`
                    });
                }
            }
        });
    }
};
//# sourceMappingURL=index.js.map