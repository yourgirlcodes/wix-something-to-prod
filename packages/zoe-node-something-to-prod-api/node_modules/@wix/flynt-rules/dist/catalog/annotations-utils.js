"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.findFieldByPath = void 0;
const proto_syntax_tree_1 = require("@wix/proto-syntax-tree");
function findFieldByPath(startFrom, path) {
    const paths = path.split('.');
    let ref = startFrom;
    let fieldName;
    while (ref && (fieldName = paths.shift())) {
        const field = getFieldOrOneof(ref, fieldName);
        if (!field || paths.length === 0) {
            return field;
        }
        else {
            ref = getNextRef(field);
        }
    }
}
exports.findFieldByPath = findFieldByPath;
function getNextRef(fieldOrOneOf) {
    if ('fieldType' in fieldOrOneOf) {
        if (fieldOrOneOf.fieldType.kind === proto_syntax_tree_1.FieldKind.Repeated) {
            return fieldOrOneOf.fieldType.elementType.message;
        }
        else {
            return fieldOrOneOf.fieldType.message;
        }
        return undefined;
    }
    return fieldOrOneOf;
}
function getFieldOrOneof(container, fieldName) {
    const field = container.fields.find(f => f.name === fieldName);
    if (field) {
        return field;
    }
    if ('oneofs' in container) {
        return container.oneofs.find(f => f.name === fieldName);
    }
}
//# sourceMappingURL=annotations-utils.js.map