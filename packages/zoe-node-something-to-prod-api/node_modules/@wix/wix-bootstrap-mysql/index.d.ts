import * as _MySql from 'mysql';

export = BootstrapMysql;

declare function BootstrapMysql(): object;

declare namespace BootstrapMysql {
  export import Mysql = _MySql;

  export interface BootstrapMysqlOptions {
    readOnly?: boolean;
    maxLifetime?: number;
    multipleStatements?: boolean;
    charset?: string;
    cluster?: string;
  }

  interface AsyncQueryFunction {
    (sql: string, params?: any[]): Promise<any>;
  }

  interface PluginOptions {
    readonly disableHealthChecks: boolean;
  }

  export interface BootstrapMysqlDatabase extends _MySql.Pool {
    queryPromise: AsyncQueryFunction;
    queryAsync: AsyncQueryFunction;
  }

  export interface BootstrapMysql {
    client(dbName: string, options?: BootstrapMysqlOptions): BootstrapMysqlDatabase;
  }
}

declare module '@wix/wix-bootstrap-api-plugins' {
  export interface BootstrapContext {
    readonly mysql: BootstrapMysql.BootstrapMysql;
  }
}

declare module '@wix/wix-bootstrap-api' {
  export interface BootstrapContext {
    readonly mysql: BootstrapMysql.BootstrapMysql;
  }
}
