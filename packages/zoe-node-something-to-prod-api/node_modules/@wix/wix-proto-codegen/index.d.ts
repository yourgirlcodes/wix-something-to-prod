import {Root, ReflectionObject} from '@wix/wnp-protobufjs';

export interface Target {
  name: string;
  dir: string;
}

export interface ICodegenOptions {
  target?: Target;
  moduleDir: string;
  skipGeneration?: boolean;
  strictMode?: boolean;
  alternateCommentMode?: boolean;
  preferTrailingComment?: boolean;
  skipOptionsValidation?: string[] | boolean;
  stdCase?: boolean;
}

export class CodeGenerationError extends Error {
  constructor(message: string, opts: {cause: Error | string});
  get cause(): Error | undefined;
}

export namespace tools {
  export function listBundledProtoFiles(): string[];
  export function listBundledRoots(): string[];
  export function protoAstTraverser(node: ReflectionObject): ProtoAstTraverser;

  export type ProtoAstTraverser = { visit(handlers: { [k: string]: (node: any) => void }): void };

  export class Module {

  }
}

export default function wixProtoCodegen(opts: ICodegenOptions): Promise<Root>;

export function generateFromJson(json: object): Promise<string>;
