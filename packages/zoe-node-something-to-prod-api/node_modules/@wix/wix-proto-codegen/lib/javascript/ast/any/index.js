/**
 * This is an alternative approach instead of building JS AST using the estree-builder.
 * Since `Any` code is static we can simply embed its AST as a whole.
 * So we read its sources from ./Any.js and transform to JS AST using acorn, then we
 * clean up location properties (start & end) due to some bug in estree-builder
 */
const fs = require('fs');
const path = require('path');
const acorn = require('acorn');
const {cloneDeepWith} = require('lodash');

// required due to a bug in estree-builder#isLocationNode
function dropLocation(value) {
  if (value) {
    delete value.start;
    delete value.end;
  }
}

const program = fs.readFileSync(path.join(__dirname, 'Any.js'), {encoding: 'utf8'});
module.exports = cloneDeepWith(acorn.parse(program, {ecmaVersion: 9}), dropLocation);