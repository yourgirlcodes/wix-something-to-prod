const {util} = require('@wix/wix-proto-runtime-toolkit');

class ValidationError extends Error {
  constructor(message, node) {
    super(message);
    this._node = node;
  }

  get node() {
    return this._node;
  }
}

function throwError(node, message) {
  const delimiter = node.constructor.name === 'Type' ? '.' : '#';
  const prefix = util.fqn(node).replace(/\.([^.]*)$/, `${delimiter}$1`);
  throw new ValidationError(`${prefix} - ${message}`, node);
}

module.exports = {ValidationError, throwError};