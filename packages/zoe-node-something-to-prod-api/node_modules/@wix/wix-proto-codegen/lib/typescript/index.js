const {generateClientServerTypeScript} = require('./codegenTyped'),
  {getCamelCaseImpl} = require('@wix/wnp-rpc-common'),
  {generateDefaultTypeScript} = require('./codegen');

function generateTypeScript(proto, {stringEnums, stringLongs, tsClasses, withAspectStore, skipClientServer, withAspectlessServices, tsExportDefault, stdCase}) {
  const methodCamelCase = getCamelCaseImpl(stdCase).methodCamelCase;

  const result = {
    src: generateDefaultTypeScript(proto, {
      stringEnums,
      stringLongs,
      tsClasses,
      withAspectStore,
      tsExportDefault,
      methodCamelCase,
    }),
  };

  if (!skipClientServer) {
    result.server = generateClientServerTypeScript(proto, true, {stringEnums, stringLongs, tsClasses, withAspectStore, methodCamelCase});
    result.client = generateClientServerTypeScript(proto, false, {stringEnums, stringLongs, tsClasses, withAspectStore, withAspectlessServices, methodCamelCase});
  }
  return result;
}

module.exports = {generateTypeScript};
