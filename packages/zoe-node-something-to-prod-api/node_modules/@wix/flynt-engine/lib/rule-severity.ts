import {LintRule} from '../index';

export enum Severity { Warning = 'warning', Error = 'error', Off = 'off'}

export type GracePeriod = {
  severityAfterGrace: Severity;
  graceUntil: Date;
};

const DEFAULT_SEVERITY: Severity = Severity.Warning;

export function getRuleSeverity(rule: LintRule, date: Date = new Date()): {severity: Severity; gracePeriod?: GracePeriod} {
  if (rule.severity) {
    if (rule.graceUntil && rule.graceUntil > date) {
      return {severity: DEFAULT_SEVERITY, gracePeriod: {severityAfterGrace: rule.severity, graceUntil: rule.graceUntil}};
    }
    return {severity: rule.severity};
  }

  return {severity: DEFAULT_SEVERITY};
}
