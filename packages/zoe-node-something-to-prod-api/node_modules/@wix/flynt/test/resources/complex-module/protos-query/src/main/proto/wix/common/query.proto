syntax = "proto3";

package wix.common;

import "google/protobuf/struct.proto";
import "wix/common/paging.proto";
import "wix/common/sorting.proto";
import "wix/api/annotations.proto";

option java_multiple_files = true;
option java_outer_classname = "QueryProto";
option java_package = "com.wix.common";



message Query {
    option (.wix.api.decomposition_minimum_fields) = {
        field: "filter"
        field: "sort"
        field: "paging"
    };
    //A filter object. See documentation [here](https://bo.wix.com/wix-docs/rnd/platformization-guidelines/api-query-language#platformization-guidelines_api-query-language_defining-in-protobuf)
    google.protobuf.Value filter = 1;
    //Sort object in the form [{"fieldName":"sortField1"},{"fieldName":"sortField2","direction":"DESC"}]
    repeated Sorting sort = 2;
    //Limit number of results
    Paging paging = 3;
    //Projection on the result object - list of specific field names to return. If fieldsets are also specified, return the union of fieldsets and fields
    repeated string fields = 4;
    //Projection on the result object - list of named projections. E.g. "basic" will return id and name fields. Specifying multiple fieldsets will return the union of fields from all. Specifying fieldsets and fields will also return the union of fields.
    repeated string fieldsets = 5;
}

message QueryV2 {
    option (.wix.api.decomposition_minimum_fields) = {
        field: "filter"
        field: "sort"
        field: "paging"
    };
    option (.wix.api.decomposition_minimum_fields) = {
        field: "filter"
        field: "sort"
        field: "cursorPaging"
    };
    //A filter object. See documentation [here](https://bo.wix.com/wix-docs/rnd/platformization-guidelines/api-query-language#platformization-guidelines_api-query-language_defining-in-protobuf)
    google.protobuf.Struct filter = 1;
    //Sort object in the form [{"fieldName":"sortField1"},{"fieldName":"sortField2","direction":"DESC"}]
    repeated Sorting sort = 2;
    //Projection on the result object - list of specific field names to return. If fieldsets are also specified, return the union of fieldsets and fields
    repeated string fields = 4;
    //Projection on the result object - list of named projections. E.g. "basic" will return id and name fields. Specifying multiple fieldsets will return the union of fields from all. Specifying fieldsets and fields will also return the union of fields.
    repeated string fieldsets = 5;
    oneof pagingMethod {
        //Pointer to page of results using offset. Can not be used together with 'cursorPaging'
        Paging paging = 3;
        //Cursor pointing to page of results. Can't be used together with 'paging'. 'cursorPaging.cursor' can not be used together with 'filter' or 'sort'
        CursorPaging cursorPaging = 6;
     }
}
