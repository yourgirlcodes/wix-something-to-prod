## @wix/artifact-description

This package is intended to be used Wix-wide by various tools from all development lifecycles (
Yoshi, CI, etc.).It provides the essential details about the production artifact that is defined by
a package in a monorepo. These details include, for instance, the artifact key (artifact ID, group
ID), whether the artifact generates a docker image, whether the artifact generates static resources,
etc.

Motivation: by providing a one-stop-shop for reading these details, we enable all
software-development-lifecycle tools to agree on how these details are represented, thus reducing
bugs across the Wix-ecosystem and allowing new features to be easily introduced.

Moreover, one of the main goals of this package is to retire the use of pom.xml files in the Wix
codebase.

### At a glance

- A production artifact is defined by a special attribute (`wix.artifact`) at the `package.json`
  file. The exact schema of this attribute is defined by the `WixArtifactSchema` interface defined
  in this package.
- Use the `extractDescription()` function to read the `wix.artifact` attribute. The function returns
  an `ArtifactDescription` object.
- If you only care about the group ID, artifact ID, you can use the `extractKey()` function, which
  returns an `ArtifactKey` object containing these two strings.
- Both of these functions fall back to the `pom.xml` file if the `package.json` does not contain
  a `wix.artifact` attribute. This allows backward compatibility and a clean forward migration.

### Example: extractDescription

```typescript
import { extractDescription, ArtifactDescription } from '@wix/artifact-description'

const description: ArtifactDescription = await extractDescription('path/to/my-monorepo/packages/my-package')
if (!description.key) {
  console.log(`This package does not produce a GAable artifact`)
} else {
  console.log(`This package produces a GAable artifact.`)
  console.log(`group ID=${description.key.groupId}, artifact ID=${description.key.artifactId}`)
  if (description.targets.docker) {
    console.log(`This package produces a docker image.`)
  }
}
```

### Example: extractKey

```typescript
import { extractKey, ArtifactKey } from '@wix/artifact-description'

const key: ArtifactKey = extractKey('path/to/my-monorepo/packages/my-package')
if (key) {
  console.log(`group ID=${key.groupId}, artifact ID=${key.artifactId}`)
}
```

### Source code

- [ArtifactDescription](src/artifact-description.ts)
- [ArtifactKey](src/artifact-key.ts)
- [schema of of the `wix.artifact` attribute](src/wix-artifact-schema.ts)
- [extractDescription()](src/extract-description.ts)
- [extractKey()](src/extract-key.ts)
