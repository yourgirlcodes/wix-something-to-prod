syntax = "proto3";

package wix.api.funnel.builder.backoffice;

import "google/api/annotations.proto";
import "google/protobuf/empty.proto";
import "google/protobuf/wrappers.proto";
import "google/protobuf/timestamp.proto";

import "wix/api/annotations.proto";
import "wix/api/validations.proto";
import "wix/api/permissions.proto";
import "wix/api/context.proto";
import "wix/common/paging.proto";

import "wix/api/funnel/builder/backoffice/template.proto";

service BackofficeTemplateService {
    rpc CreateTemplate (CreateTemplateRequest) returns (CreateTemplateResponse) {
        option (google.api.http).post = "/backoffice/templates";
        option (wix.api.maturity) = ALPHA;
        option (wix.api.exposure) = INTERNAL;
        option (wix.api.permission).name = "FUNNEL_INTRO.MANAGE_CONTENT";
        option (wix.api.required) = "CreateTemplateRequest.template";
    }

    rpc GetTemplate (GetTemplateRequest) returns (GetTemplateResponse) {
        option (google.api.http).get = "/backoffice/templates/{id}";
        option (wix.api.maturity) = ALPHA;
        option (wix.api.exposure) = INTERNAL;
        option (wix.api.permission).name = "FUNNEL_INTRO.MANAGE_CONTENT";
    }

    rpc ListTemplates (ListTemplatesRequest) returns (ListTemplatesResponse) {
        option (google.api.http).get = "/backoffice/templates";
        option (wix.api.maturity) = ALPHA;
        option (wix.api.exposure) = INTERNAL;
        option (wix.api.permission).name = "FUNNEL_INTRO.MANAGE_CONTENT";
    }

    rpc SetTemplate (SetTemplateRequest) returns (SetTemplateResponse) {
        option (google.api.http).put = "/backoffice/templates/{id}";
        option (wix.api.maturity) = ALPHA;
        option (wix.api.exposure) = INTERNAL;
        option (wix.api.permission).name = "FUNNEL_INTRO.MANAGE_CONTENT";
        option (wix.api.required) = "SetTemplateRequest.template";
    }

    rpc ArchiveTemplate (ArchiveTemplateRequest) returns (ArchiveTemplateResponse) {
        option (google.api.http).delete = "/backoffice/templates/{id}";
        option (wix.api.maturity) = ALPHA;
        option (wix.api.exposure) = INTERNAL;
        option (wix.api.permission).name = "FUNNEL_INTRO.MANAGE_CONTENT";
    }
}

message CreateTemplateRequest {
    Template template = 1;
}

message CreateTemplateResponse {
    Template template = 1;
}

message GetTemplateRequest {
    string id = 1 [(wix.api.minLength) = 1, (wix.api.maxLength) = 100];
}

message GetTemplateResponse {
    Template template = 1;
}

message ListTemplatesRequest {
    wix.common.Paging paging = 1;
}

message ListTemplatesResponse {
    repeated Template templates = 1;
}

message SetTemplateRequest {
    string id = 1 [(wix.api.minLength) = 1, (wix.api.maxLength) = 100];

    // Expected version performing the operation. Will fail on no match.
    int32 version = 2 [(wix.api.min) = 1];

    Template template = 3;
}

message SetTemplateResponse {
    Template template = 1;
}

message ArchiveTemplateRequest {
    string id = 1 [(wix.api.minLength) = 1, (wix.api.maxLength) = 100];
}

message ArchiveTemplateResponse {
}

