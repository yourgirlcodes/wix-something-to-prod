syntax = "proto3";

package wix.api.funnel.builder.backoffice;

import "google/api/annotations.proto";
import "google/protobuf/wrappers.proto";
import "google/protobuf/timestamp.proto";

import "wix/api/validations.proto";

message Page {
    string id = 1 [(wix.api.readOnly) = true, (wix.api.format) = GUID];

    string template_id = 2 [(wix.api.minLength) = 1, (wix.api.maxLength) = 100];

    string name = 3 [(wix.api.minLength) = 1, (wix.api.maxLength) = 100];

    // Current version of the page. Used for optimistic locking.
    // Operations which mutate the page will require the current expected version as a parameter and fail if it doesn't match.
    // Read-Only, cannot be changed by the API.
    int32 version = 4 [(wix.api.readOnly) = true];

    string translation_key = 5 [(wix.api.minLength) = 1, (wix.api.maxLength) = 100];

    map<string, ContentComponent> content = 6;

    google.protobuf.Timestamp created_at = 7;

    google.protobuf.Timestamp updated_at = 8;

    google.protobuf.Timestamp deleted_at = 9;
}

message ContentComponent {
    oneof body {
        double number = 1;

        string text = 2;

        bool boolean = 3;

        google.protobuf.Timestamp date = 4;

        ChoiceQuestion choice_question = 5;

        FreeTextQuestion free_text_question = 6;
    }
}

message ChoiceQuestion {
    message AnswerOption {
        string option_key = 1 [(wix.api.minLength) = 1, (wix.api.maxLength) = 30];

        map<string, ContentComponent> content = 2;
    }

    string question_key = 1 [(wix.api.minLength) = 1, (wix.api.maxLength) = 30];

    map<string, ContentComponent> content = 2;

    repeated AnswerOption options = 3;
}

message FreeTextQuestion {
    string question_key = 1 [(wix.api.minLength) = 1, (wix.api.maxLength) = 30];

    map<string, ContentComponent> content = 2;
}
