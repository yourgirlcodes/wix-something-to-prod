const {GrpcStatusError} = require('..');

function matchValue(value, expected) {
  if (typeof expected === 'undefined' || (Array.isArray(expected) && expected.length === 0)) {
    return true;
  }
  return Array.isArray(expected) ? expected.includes(value) : expected === value;
}

function isGrpcStatusError(err, expectedStatus) {
  return GrpcStatusError.isInstance(err) && matchValue(err.code, expectedStatus);
}

function isValidationError(err) {
  return GrpcStatusError.isInstance(err) && !!(err.validationError);
}

function isApplicationError(err, expectedErrorCode) {
  return GrpcStatusError.isInstance(err) && !!(err.applicationError) && matchValue(err.applicationError.code, expectedErrorCode);
}

module.exports = {
  isGrpcStatusError,
  isValidationError,
  isApplicationError,
};